
# default.js
Что такое default.js и зачем он нужен в Parallel Routes?
    -default.js — это файл, который рендерится как fallback для слота, когда Next.js не может восстановить его активное состояние после жёсткой навигации (full-page load). Он нужен, чтобы слоты, не совпадающие с текущим URL, не показывали 404, а отображали заглушку.

В каких случаях Next.js использует default.js?
    - При hard navigation (F5 или прямой переход по ссылке).
    - Когда активное состояние слота не может быть восстановлено из URL.
    - Для subpages, которые не совпадают с текущим URL.

Чем отличается поведение слотов при soft navigation и hard navigation?
    - Soft navigation: Next.js отслеживает состояние каждого слота и рендерит его как есть.
    - Hard navigation: Next.js не знает активное состояние слотов, поэтому для слотов без совпадения с URL рендерится default.js (или 404, если default.js нет).
Что произойдёт, если слот не имеет default.js и Next.js не может восстановить его состояние?
    - В таком случае Next.js рендерит 404 внутри этого слота

Почему нужно создавать default.js для implicit slot children?

# Dynamic Segments
Что такое Dynamic Route Segment и как он создаётся?
    - Dynamic Segment используется, когда имена сегментов маршрута заранее неизвестны и определяются динамически. Создаётся с помощью квадратных скобок:

Как передаются dynamic params в компонент?
    - В Server Components они приходят через проп params (как promise).
    - В Client Components можно:
        - использовать use(params) для получения значения;
        - использовать хук useParams() в любом месте дерева клиента.

Что такое Catch-all Segments?
    - Catch-all [...slug] захватывает все последующие части пути в Dynamic Route Segment

Чем отличаются Catch-all и Optional Catch-all?
    - [...slug] → требует хотя бы один сегмент.
    - [[...slug]] → может быть без сегмента (/shop тоже матчится).

Что делает generateStaticParams?
    - Функция generateStaticParams позволяет заранее (на этапе сборки) сгенерировать динамические маршруты.

# error.js
Что такое error.js и зачем он нужен в Next.js?
    - это специальный файл, который позволяет обрабатывать неожиданные runtime-ошибки и показывать fallback UI вместо того, чтобы страница падала полностью. Он работает как React Error Boundary, оборачивая сегмент маршрута и его дочерние элементы.

Почему error.js должен быть Client Component?
    - Error Boundaries в React могут быть реализованы только в Client Components. Поэтому error.js всегда должен начинаться с 'use client'

Как работает error.js внутри сегмента маршрута?
    - Каждый сегмент маршрута может иметь свой error.js.
    - Если в сегменте или его дочерних компонентах происходит ошибка, Next.js рендерит error.js вместо содержимого сегмента
    - Если нужно, ошибка может "проброситься" выше к родительскому error.js

Какие пропсы получает error.js и что они означают?
    - error — объект ошибки
        - В dev-режиме включает сообщение ошибки (для удобной отладки)
        - В продакшене ошибки из Server Components передаются как безопасный объект с digest (чтобы не утекли чувствительные данные).
        - Ошибки из Client Components показывают оригинальное сообщение
    - reset — функция, которая позволяет попробовать перерисовать сегмент:

Чем отличаются ошибки из Client Components и Server Components в том, как они передаются в error.js?
    - Client Components → передаётся оригинальное сообщение ошибки
    - Server Components → передаётся обезличенное сообщение + digest, чтобы исключить утечку приватных данных.

Что делает функция reset() в error.js?
    - Она инициирует повторный рендер сегмента маршрута.

# global-error.jsx
Чем global.js отличается от global.jsx и что и когда нужно применять?
    - error.js → обрабатывает ошибки локально, внутри конкретного сегмента и его дочерних страниц.
    - global-error.jsx → глобальный обработчик, заменяющий root layout или template при ошибке. Используется для критических ошибок, которые ломают всё приложение

Почему в global-error нужно определять свои <html> и <body>?
    - global-error.jsx заменяет root layout, у него нет доступа к общим обёрткам (layout, template)

# forbidden.js

# instrumentation.js
Что такое instrumentation.js и зачем он нужен в Next.js?
    - instrumentation.js — это специальный файл для интеграции серверных инструментов наблюдаемости (observability) в Next.js. Он позволяет подключать системы вроде OpenTelemetry, Sentry или кастомные логгеры для отслеживания производительности, логирования ошибок и отладки в продакшене.

Где должен находиться файл instrumentation.js|ts?
    - В корне проекта

Когда вызывается функция register() и что в ней обычно делают?
    - register() вызывается один раз при инициализации нового экземпляра сервера Next.js. Обычно внутри неё подключают и настраивают библиотеку наблюдаемости, например OpenTelemetry или кастомный логгер

Для чего используется onRequestError и какие параметры он принимает?
    - onRequestError вызывается, когда Next.js сервер зафиксировал ошибку. Обычно его используют, чтобы отправить информацию об ошибках в сторонние сервисы
    - error — объект ошибки + digest (уникальный идентификатор ошибки).
    - request — данные запроса (path, method, headers).
    - context — контекст ошибки (тип роутера, сегмент, где упало: render, route, action, middleware).

Что такое digest у ошибки в onRequestError?
    - digest — уникальный хэш ошибки, который помогает связать ошибку в клиенте с соответствующими логами на сервере

Как можно разделить реализацию register и onRequestError для Node.js и Edge рантаймов?
    - Через process.env.NEXT_RUNTIME

# instrumentation-client.js

Что такое instrumentation-client.js и для чего он используется?
    - instrumentation-client.js|ts — это файл для добавления клиентских инструментов наблюдаемости таких как аналитики, трекинга производительности, отслеживания ошибок, полифиллов и других side-effects, которые должны работать до того, как React станет интерактивным

Где должен находиться файл instrumentation-client.js|ts?
    - в корне приложения

В какой момент жизненного цикла приложения выполняется код из instrumentation-client.js?
    - после загрузки HTML но до гидратации React и возможности взаимодействия пользователя

Для чего используется onRouterTransitionStart и какие параметры она получает?
    - Функция вызывается при начале навигации внутри приложения
    - url: string — URL, на который происходит переход.
    - avigationType: 'push' | 'replace' | 'traverse' — тип навигации


# Intercepting Routes
Что такое Intercepting Routes и для чего они используются?
    - Intercepting Routes позволяют загружать маршрут из другой части приложения в текущем layout. Это полезно, когда нужно показать контент без переключения основного контекста страницы

В чём разница между soft navigation и hard navigation при использовании Intercepting Routes?
    - Soft navigation — при клиентской навигации (например, клик по фото в ленте) маршрут перехватывается, URL маскируется, и фото показывается в модальном окне.
    - Hard navigation — при обновлении страницы или переходе по прямой ссылке весь маршрут рендерится как полноценная страница без перехвата.

Как работает (.), (..), (..)(..), и (...) при определении перехватываемых маршрутов?
    - (.) — перехватывает сегменты на том же уровне.
    - (..) — перехватывает сегменты на один уровень выше.
    - (..)(..) — на два уровня выше.
    - (...) — перехватывает сегменты начиная с корня app

Почему ( .. ) работает по сегментам маршрута, а не по файловой системе?
    - Потому что Next.js ориентируется на сегменты маршрутов, а не на структуру папок. Например, @slot в Parallel Routes не считается сегментом, поэтому относительность определяется только по route segments

# layout.js

Что такое layout.js и для чего он используется в Next.js?
    - Layout — компонент, определяющий структуру интерфейса сегмента маршрута. Оборачивает дочерние сегменты и переиспользует общий UI 

Что такое root layout и чем он отличается от обычного layout?
    - Root layout — верхний layout в app/. Обязан содержать <html> и <body>, задаёт глобальный UI для всего приложения. Вложенные layouts применяются к своим сегментам.

Какие пропсы получает layout и как их использовать?
    - children — обязательный, содержит дочерние сегменты.
    - params — опциональный промис с динамическими параметрами от корневого сегмента до текущего layout.

Как использовать LayoutProps для типизации layout?
    - LayoutProps предоставляет типы для children, params и именованных слотов (@slot) на основе структуры директорий.

Могут ли layouts перерендериваться при навигации и почему?
    - Нет. Layouts сохраняются между переходами, чтобы избегать лишних запросов и вычислений; кэшируются на клиенте.

Как layout может работать с данными?
    - Может выполнять fetch и отображать данные внутри себя. Непосредственно передавать данные дочерним страницам нельзя. Запросы дочерних страниц дедуплицируются.

Как layout работает с query params и pathname?
    - Layouts не обновляются на навигации и не получают новые query params или pathname напрямую.
    - Для работы используют useSearchParams и usePathname в Client Components.
    - Актуальное состояние обеспечивают дочерние страницы или клиентские компоненты внутри layout.

Как layout может взаимодействовать с дочерними сегментами?
    - Прямого доступа нет. Для определения активного сегмента используют useSelectedLayoutSegment или useSelectedLayoutSegments в Client Components.

Может ли layout быть клиентским (CSR)?
    - Root layout — нет; должен быть серверным и содержать <html> и <body>.
    - Вложенные layouts — да; можно сделать клиентскими с 'use client'.
    - Ограничения клиентского layout: нет доступа к headers()/cookies()/draftMode(), нельзя делать серверный fetch, увеличивается размер бандла и время гидратации.

# loading.js

Что такое loading.js и для чего он используется в Next.js?
    - loading.js — это специальный файл, который позволяет создавать понятный Loading UI с использованием React Suspense. Он показывает мгновенное состояние загрузки (instant loading state) с сервера, пока контент сегмента маршрута подгружается, и автоматически заменяет его на основной контент после завершения загрузки.

Где нужно размещать файл loading.js внутри маршрута?
    - Файл loading.js размещается в папке сегмента маршрута, внутри которого вы хотите показать состояние загрузки

Какой тип компонента по умолчанию имеет loading.js и можно ли его сделать Client Component?
    - По умолчанию loading.js является Server Component, но его можно сделать Client Component, добавив директиву 'use client' в начале файла

Какие параметры принимает компонент loading.js?
    - Компонент loading.js не принимает никаких параметров

Что такое instant loading state и как его использовать?
    - Instant loading state — это UI, который показывается мгновенно при навигации, например скелетоны, спиннеры или небольшая часть будущего экрана. Он помогает пользователю понять, что приложение отвечает, и улучшает UX. Для этого создается loading.js с легковесным интерфейсом загрузки внутри соответствующего сегмента

Как loading.js взаимодействует с layout.js и page.js внутри сегмента маршрута?
    - loading.js автоматически оборачивает page.js и всех его потомков внутри <Suspense> границы, если находится в одной папке с layout.js. То есть при загрузке нового сегмента UI fallback из loading.js показывается до полного рендеринга страницы

Можно ли использовать loading.js при статическом экспорте сайта?
    - Нет, loading.js не поддерживается при статическом экспорте

Как вручную создавать Suspense Boundaries для своих компонентов и как это соотносится с loading.js?
    - Можно вручную обернуть любой асинхронный компонент в <Suspense fallback={...}>. В этом случае fallback UI работает аналогично loading.js, показывая UI пока выполняется асинхронное действие

Какие преимущества дает использование Suspense вместе с loading.js?
    - Streaming Server Rendering — прогрессивный рендеринг HTML с сервера на клиент
    - Selective Hydration — React делает интерактивными компоненты приоритетно, в зависимости от взаимодействия пользовател
    - Автоматическое отображение fallback UI и плавная замена его на основной контент

# not-found.js

Для чего используется файл not-found.js в Next.js?
    - Он рендерит UI, когда внутри сегмента маршрута вызывается notFound(). Используется для обработки 404 на уровне конкретного сегмента.

Чем отличается not-found.js от global-not-found.js?
    - not-found.js работает в пределах сегмента и зависит от маршрута.
    - global-not-found.js используется для глобальной 404-страницы, если URL вообще не совпал ни с одним маршрутом.

Какой статус код возвращает Next.js при использовании not-found.js?
    - Для стриминговых ответов → 200.
    - Для нестриминговых → 404.

В каких случаях стоит использовать global-not-found.js?
    - Когда в приложении есть несколько root layout’ов.
    - Когда root layout определён с динамическими сегментами (например, app/[country]/layout.js).

Почему global-not-found.js должен возвращать полный HTML-документ?
    - Потому что он обходит обычный процесс рендеринга приложения, и Next.js ожидает полный HTML (с <html> и <body>).

Какие props принимают компоненты not-found.js и global-not-found.js?
    - Они не принимают никаких props

Можно ли в not-found.js выполнять серверный fetch?
    - Да, он является серверным компонентом и может быть async. Можно, например, использовать headers() и загружать данные для отображения кастомного 404-UI

Какие метаданные автоматически добавляет Next.js для страниц с 404?
    - Автоматически вставляется <meta name="robots" content="noindex" />, чтобы такие страницы не индексировались поисковиками.


# page.js

Для чего используется файл page.js в Next.js?
    - Файл page.js используется для определения UI, уникального для маршрута. Это конечная точка (leaf) дерева маршрутов, которая делает сегмент публично доступным.

Является ли page.js обязательным для того, чтобы сегмент маршрута был публично доступен?
    - Да, без page.js сегмент маршрута не будет доступен пользователю напрямую.

Что означает, что страница всегда является листом (leaf) дерева маршрутов?
    - Это значит, что страница (page.js) всегда находится на нижнем уровне маршрута — она не может иметь вложенных сегментов под собой Вложенные сегменты должны определяться выше.

Какой компонент по умолчанию является page.js — серверным или клиентским? Можно ли его изменить?
    - По умолчанию page.js — Server Component, но его можно сделать Client Component, добавив директиву "use client" в начале файла.

Какие расширения файлов поддерживает Next.js для страниц?
    - Поддерживаются расширения: .js || .jsx || .tsx

Какие props доступны в page.js и для чего они нужны?
    - params — объект (Promise), содержащий динамические параметры маршрута ([slug], [id] и т.п.).
    - searchParams — объект (Promise), содержащий параметры строки запроса (?a=1&b=2).

В какой форме передаются params и searchParams в Next.js 15 и как они отличаются от версии 14?
    - В Next.js 15: params и searchParams передаются как Promise, их нужно обрабатывать через await или React use, В Next.js 14 и ниже: они были синхронными объектами

Как получить значения из params и searchParams в серверном компоненте?
    - Использовать async/await:

Как получить значения из params и searchParams в клиентском компоненте, где нельзя использовать async?
    - В клиентском компоненте можно использовать React-хук use для чтения Promise

Что происходит при использовании searchParams в странице относительно рендера (статический или динамический)?
    - Использование searchParams переводит страницу в динамический рендеринг на уровне запроса, так как их значения нельзя предсказать заранее.

Чем отличается searchParams от стандартного объекта URLSearchParams?
    - searchParams — это обычный JS-объект ({ a: '1', b: '2' }), а не экземпляр URLSearchParams.
    - Значения могут быть строкой или массивом строк (string | string[]).

Что такое PageProps helper и зачем его использовать?
    -PageProps — это глобально доступный TypeScript-хелпер, который позволяет типизировать params и searchParams на основе буквального маршрута, добавляет автодополнение ключей и строгую типизацию, автоматически генерируется при next dev, next build или next typegen.

# Parallel Routes

# public Folder

Для чего используется папка public в Next.js?
    - Для хранения статических файлов, которые нужно отдать напрямую без обработки.

Как можно обратиться к файлу, находящемуся внутри public?
    - По пути, начиная с /. Например, public/avatars/me.png доступен по адресу /avatars/me.png.

Какой HTTP-заголовок кэширования применяется к файлам из public по умолчанию?
    - Cache-Control: public, max-age=0

Почему Next.js не кэширует файлы в public на длительное время?
    - Потому что содержимое файлов в public может изменяться, и Next.js не может безопасно гарантировать их долговременное кэширование.

Где рекомендуется хранить статические метаданные (robots.txt, favicon.ico и т.п.) в новых проектах Next.js?
    - Внутри специальных metadata-файлов в папке app, а не в public

# route.js

# Route Groups

Что такое Route Groups в Next.js?
    - Это соглашение для организации маршрутов в папки, которые не влияют на URL.

Как создаётся группа маршрутов в файловой структуре?
    - Папку нужно обернуть в скобки, например: (shop) или (marketing).

Влияет ли название группы маршрутов (в скобках) на конечный URL?
    - Нет, оно используется только для организации структуры и не попадает в путь

Для чего обычно используют Route Groups?
    - для организации маршрутов по фичам или командам,
    - для создания нескольких root layouts,
    - разделить набор страниц по разным layout, не смешивая их

Можно ли с помощью Route Groups определить несколько root layout?
    - Да, каждая группа может иметь свой собственный root layout.

Что произойдёт при навигации между страницами, которые используют разные root layout?
    - Это приведёт к полной перезагрузке страницы (full page reload).

Какая проблема может возникнуть, если маршруты в разных группах разрешаются в один и тот же путь?
    - Возникнет конфликт: разные файлы будут пытаться отрендерить один и тот же URL, что вызовет ошибку.

Что нужно учитывать при использовании нескольких root layout и отсутствии общего top-level layout.js?
    - Нужно, чтобы маршрут / был определён хотя бы в одной из групп, например в app/(marketing)/page.js.
# Route Segment Config

# src Folder

# template.js