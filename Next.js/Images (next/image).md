### Images (next/image) — краткий конспект (теория)

- **Проблемы, которые решает**: layout shift при загрузке изображений, неоптимизированные размеры файлов для viewport/устройства, сложность настройки правильного отображения и позиционирования.

### Основные возможности
- **Автоматическая оптимизация**: конвертация в современные форматы (AVIF, WebP), сжатие, адаптация под устройство и браузер.
- **Предотвращение layout shift**: автоматическое определение width/height при импорте локальных файлов.
- **Responsive по умолчанию**: изображения автоматически адаптируются под размер viewport.
- **Без обёрток**: в современных версиях Next.js нет дополнительных wrapper-элементов, только нативный `<img>`.

### Базовое использование
- **Локальные изображения**: импорт из `public/` директории, автоматическое определение размеров.
- **Внешние изображения**: через URL с обязательной настройкой allowlist доменов в конфиге.
- **Обязательные пропы**: `alt` для доступности, `src` для источника, `width/height` для предотвращения layout shift.

### Конфигурация внешних доменов
- **Безопасность**: явный allowlist доменов в `next.config.js` для предотвращения злоупотреблений оптимизацией.
- **Паттерны URL**: можно задавать конкретные пути и поддомены для более точного контроля.
- **Форматы**: настройка поддерживаемых форматов (AVIF, WebP) в конфиге.

### Fill prop и размеры
- **Fill**: вместо фиксированных width/height позволяет изображению заполнить родительский контейнер.
- **Обязательный sizes**: при использовании `fill` необходимо указывать `sizes` для правильной генерации srcset.
- **Responsive breakpoints**: `sizes` определяет, какие варианты изображения генерировать для разных размеров экрана.

### Качество и placeholder
- **Quality prop**: по умолчанию 75%, можно увеличить до 100% для фоновых изображений.
- **Blur placeholder**: автоматическая генерация размытого placeholder для локальных изображений.
- **Лучший UX**: placeholder улучшает восприятие загрузки.

### CSS и позиционирование
- **Object-fit**: `cover`, `contain`, `none` — контроль того, как изображение заполняет контейнер.
- **Стилизация**: через `style` prop или CSS классы.
- **Positioning**: `fill` требует `position: relative` у родительского элемента.

### Grid и множественные изображения
- **CSS Grid**: комбинация с `fill` и `object-fit: cover` для адаптивных сеток изображений.
- **Responsive grid**: автоматическое масштабирование благодаря CSS Grid и Next.js оптимизации.
- **Фиксированная высота**: родительский контейнер должен иметь определённую высоту для корректной работы `fill`.

### Responsive поведение
- **Автоматическая адаптация**: изображения автоматически подстраиваются под размер viewport.
- **Flexible layouts**: хорошо работает с flexbox, grid и другими CSS-схемами.
- **Mobile-first**: оптимизация для мобильных устройств по умолчанию.

### Loaders и кастомизация
- **Встроенный loader**: оптимизация на Next.js сервере по умолчанию.
- **Внешние сервисы**: возможность подключения сторонних CDN/сервисов оптимизации через кастомный loader.
- **Параметры loader**: передача source, width, quality в функцию loader для гибкой настройки.

### Практические рекомендации
- **Всегда указывайте alt**: для доступности и SEO.
- **Используйте fill + sizes**: для адаптивных изображений вместо фиксированных размеров.
- **Настройте allowlist**: для внешних изображений в целях безопасности.
- **Оптимизируйте качество**: балансируйте между размером файла и визуальным качеством.
- **Тестируйте на разных устройствах**: проверяйте корректность отображения и производительность.

### Производительность
- **Автоматическое сжатие**: значительное уменьшение размера файлов (пример: 30KB → 7KB).
- **Современные форматы**: AVIF/WebP для браузеров с поддержкой.
- **Lazy loading**: по умолчанию включён для изображений вне viewport.
- **Кеширование**: оптимизированные изображения кешируются для повторного использования.

### Ограничения и замечания
- **Обязательные размеры**: для предотвращения layout shift необходимо указывать width/height или использовать fill.
- **Конфигурация доменов**: внешние изображения требуют явной настройки allowlist.
- **Родительский контейнер**: при использовании `fill` родитель должен иметь `position: relative` и определённые размеры.


