## Добавление данных, оператор INSERT

INSERT предназначен для добавления новых записей в таблицу.

```sql
INSERT INTO имя_таблицы [(поле_таблицы, ...)]
VALUES (значение_поля_таблицы, ...)
| SELECT поле_таблицы, ... FROM имя_таблицы ...
```
Общая структура запроса с INSERT

Значения можно вставлять перечислением с помощью слова VALUES или с помощью оператора SELECT.

## Перечисление полей и соответствие значениям

При использовании INSERT можно явно указать, в какие поля таблицы будут вставлены данные.

```sql
INSERT INTO имя_таблицы (поле1, поле2, поле3)
VALUES (значение1, значение2, значение3);
```
Явное указание полей

Важные правила:
- Порядок значений в VALUES должен строго соответствовать порядку полей в перечислении
- Количество значений должно совпадать с количеством указанных полей
- Если поле не указано в перечислении, оно получит значение по умолчанию (если задано) или NULL (если поле допускает NULL)

```sql
INSERT INTO Goods (good_id, good_name, type)
VALUES (20, 'Table', 2);
```
Явное указание полей

```sql
INSERT INTO Goods (good_name, type, good_id)
VALUES ('Table', 2, 20);
```
Изменённый порядок полей — значения меняются соответственно

Если не указывать список полей, то значения должны быть перечислены для всех полей таблицы в том порядке, в котором они были определены при создании таблицы:

```sql
INSERT INTO Goods
VALUES (20, 'Table', 2);
```
Вставка без указания полей

Рекомендуется всегда явно указывать список полей. Это делает код более читаемым, защищает от ошибок при изменении структуры таблицы и позволяет вставлять значения только в нужные поля.

## INSERT INTO ... VALUES

Используется для вставки заранее известных значений. Может вставлять одну или несколько строк за раз.

```sql
INSERT INTO Goods (good_id, good_name, type)
VALUES (20, 'Table', 2);
```
Вставка одной строки

```sql
INSERT INTO Goods (good_id, good_name, type)
VALUES
    (20, 'Table', 2),
    (21, 'Chair', 2),
    (22, 'Lamp', 8);
```
Вставка нескольких строк

Когда использовать: для вставки конкретных, статических данных, которые известны заранее.

## INSERT INTO ... SELECT

Используется для вставки данных, полученных из запроса. Позволяет копировать данные из одной таблицы в другую или вставлять результаты сложных вычислений.

```sql
INSERT INTO Goods (good_id, good_name, type)
SELECT 20, 'Table', 2;
```
Вставка через SELECT с константами

```sql
INSERT INTO Goods (good_id, good_name, type)
SELECT good_id + 100, good_name, type
FROM Goods
WHERE type = 2;
```
Копирование и преобразование данных из другой таблицы

Когда использовать: для копирования данных между таблицами, вставки результатов вычислений или когда данные зависят от существующих записей в базе.

## Первичный ключ при добавлении новой записи

Первичный ключ таблицы является уникальным значением. Добавление уже существующего значения приведёт к ошибке.

```sql
INSERT INTO Goods SELECT MAX(good_id) + 1, 'Table', 2 FROM Goods;
```
Получение максимального значения первичного ключа для генерации нового уникального значения

Этот способ не самый надёжный, так как может привести к неконсистентности данных, если значение было удалено.

## Автоматическая генерация первичного ключа

В PostgreSQL есть механизм для автоматической генерации уникального идентификатора: типы SMALLSERIAL, SERIAL, BIGSERIAL.

Столбец с одним из этих типов будет являться целочисленным и автоматически увеличиваться при добавлении новой записи.

```sql
CREATE TABLE Goods (
	good_id SERIAL,
	good_name VARCHAR(255),
	type INT
);
```
Создание таблицы с автоматической генерацией первичного ключа

```sql
INSERT INTO Goods (good_name, type) VALUES ('Table', 2);
```
При вставке не нужно указывать значение для SERIAL поля — оно генерируется автоматически
